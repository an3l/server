#
# MDEV 18284
#
CREATE TABLE json_test(a JSON, b JSON);
INSERT INTO json_test VALUES ("[1, 2,  3]", '{"a":"  foo "}');
DESC json_test;
Field	Type	Null	Key	Default	Extra
a	longtext	YES		NULL	
b	longtext	YES		NULL	
SELECT * FROM json_test;
a	b
[1, 2,  3]	{"a":"  foo "}
# JSON_COMPACT works with arrays
# JSON_COMPACT doesn't work with objects
# Altough JSON_COMPACT(a) works in SELECT doesn't work -JSON_OBJECT?
SELECT JSON_OBJECT ("a", JSON_COMPACT(a)) FROM (SELECT * FROM json_test) AS derived_table;
JSON_OBJECT ("a", JSON_COMPACT(a))
{"a": [1, 2,  3]}
# Use JSON_COMPACT on a field from alias - array -> doesn't work
# JSON_COMPACT(b) doesn't work in JSON_OBJECT either
# Use JSON_COMPACT on a field from alias - object-> doesn't work
# Use JSON_COMPACT as a values -> works
# Use JSON_COMPACT on one field and no JSON_COMPACT on second field -> doesn't work
SELECT JSON_OBJECT ("a", JSON_COMPACT(a), "b", b) FROM (SELECT * FROM json_test) AS derived_table;
JSON_OBJECT ("a", JSON_COMPACT(a), "b", b)
{"a": "[1,2,3]", "b": "{\"a\":\"  foo \"}"}
DROP TABLE json_test;
